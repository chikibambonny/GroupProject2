import speech_recognition as sr
import os

def transcribe_from_microphone():
    recognizer = sr.Recognizer()

    try:
        with sr.Microphone() as source:
            print("üé§ Listening... Speak now.")
            recognizer.adjust_for_ambient_noise(source)
            audio = recognizer.listen(source)
    except OSError:
        print("‚ùå No microphone detected! Please plug one in or choose the file option.")
        return

    print("‚è≥ Recognizing...")
    try:
        text = recognizer.recognize_google(audio)
        print("‚úÖ You said:", text)
    except Exception as e:
        print("‚ùå Error:", e)


def transcribe_from_file():
    recognizer = sr.Recognizer()

    file_path = input("üìÅ Enter the audio file path (WAV/MP3/FLAC): ")

    if not os.path.exists(file_path):
        print("‚ùå File not found.")
        return

    try:
        with sr.AudioFile(file_path) as source:
            print("üéµ Reading audio file...")
            audio = recognizer.record(source)
    except Exception as e:
        print("‚ùå Could not read the file:", e)
        return

    print("‚è≥ Recognizing...")
    try:
        text = recognizer.recognize_google(audio)
        print("‚úÖ Transcription:", text)
    except Exception as e:
        print("‚ùå Error:", e)


def main():
    print("Choose an option:")
    print("1: üé§ Microphone Speech-to-Text")
    print("2: üìÅ File Speech-to-Text")

    choice = input("Enter 1 or 2: ")

    if choice == "1":
        transcribe_from_microphone()
    elif choice == "2":
        transcribe_from_file()
    else:
        print("‚ùå Invalid choice.")


if __name__ == "__main__":
    main()
